#
# Hocuspocus VPN Kill Switch
#
# This configuration blocks ALL traffic except:
# - VPN server connection
# - Traffic through VPN tunnel
# - Local loopback
# - DHCP for network connectivity
#
# Generated: Fri Jan 16 19:01:33 CET 2026
# VPN Server: 35.210.225.36
#

# Options
set block-policy drop
set skip on lo0

# Scrub incoming packets
scrub in all

# Block all traffic by default
block drop all

# Allow loopback
pass quick on lo0 all

# Allow DHCP (needed to connect to WiFi/Ethernet)
pass out quick proto udp from any port 68 to any port 67

# Allow DNS to resolve VPN server (optional, remove if using IP only)
# pass out quick proto udp to any port 53

# Allow connection to VPN server (IKEv2)
pass out quick proto udp from any to 35.210.225.36 port 500
pass out quick proto udp from any to 35.210.225.36 port 4500
pass in quick proto udp from 35.210.225.36 port 500 to any
pass in quick proto udp from 35.210.225.36 port 4500 to any

# Allow ESP protocol for IKEv2
pass out quick proto esp from any to 35.210.225.36
pass in quick proto esp from 35.210.225.36 to any

# Allow all traffic through VPN tunnel interfaces (utun0, utun1, etc.)
pass quick on utun0 all
pass quick on utun1 all
pass quick on utun2 all
pass quick on utun3 all

# Allow established connections (for VPN tunnel)
pass in quick proto tcp all flags S/SA keep state
pass out quick proto tcp all flags S/SA keep state
